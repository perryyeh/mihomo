services:
  mihomo:
    image: metacubex/mihomo:latest
    container_name: mihomo
    hostname: mihomo
    restart: always
    cap_add:
      - NET_ADMIN
    devices:
      - /dev/net/tun:/dev/net/tun
    mac_address: ${mihomomac}
    networks:
      macvlan:
        ipv4_address: ${mihomo4}
    volumes:
      - ./:/root/.config/mihomo

networks:
  macvlan:
    external: true
    name: ${MACVLAN_NET}