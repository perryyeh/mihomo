import{i as e,o as t,s as n,t as r}from"./DmF15YAy.js";import{$ as i,C as a,Dt as o,Et as s,F as c,G as l,H as u,J as d,K as f,L as p,Ot as m,P as h,Q as g,R as _,U as v,V as y,W as b,X as ee,Z as x,_t as S,at as C,ct as w,dt as T,ft as E,j as te,kt as D,ot as O,pt as k,q as A,st as j,x as ne,yt as M,z as N}from"./SdXlftKS.js";import{h as P}from"./_v7-ePgP.js";import{t as re}from"./ZC4cO_li.js";import{F,I}from"./WbzNIdgT.js";import{a as L,i as R,n as z,o as B,r as V}from"./DlnIPlaO.js";import{t as H}from"./BUOgRipW.js";import{_ as U,h as W}from"./7zWSxfW3.js";import{t as ie}from"./BWRJQMBQ.js";import{t as ae}from"./D7QqM6sF.js";var G={class:`relative`},K=[`data-theme`],q=[`data-theme`],J=[`onClick`],Y=i({__name:`ThemeSelector`,props:{modelValue:{}},emits:[`update:modelValue`],setup(e,{emit:t}){let n=e,r=t,i=M(null),a=M(null),c=M(!1),{floatingStyles:p}=z(i,a,{placement:`bottom-start`,middleware:[L(4),R(),B({padding:8}),{name:`sameWidth`,fn({rects:e,elements:t}){return Object.assign(t.floating.style,{width:`${e.reference.width}px`}),{}}}],whileElementsMounted:V});function h(){c.value=!c.value}function _(e){r(`update:modelValue`,e),c.value=!1}function b(e){let t=e.target;!i.value?.contains(t)&&!a.value?.contains(t)&&(c.value=!1)}return C(()=>{document.addEventListener(`click`,b)}),O(()=>{document.removeEventListener(`click`,b)}),(e,t)=>(j(),d(`div`,G,[l(`button`,{ref_key:`reference`,ref:i,class:`btn w-full justify-between btn-sm`,"data-theme":n.modelValue,onClick:y(h,[`stop`])},[l(`span`,null,D(n.modelValue),1),g(s(F),{class:o([`size-4 transition-transform`,{"rotate-180":s(c)}])},null,8,[`class`])],8,K),(j(),f(v,{to:`body`},[s(c)?(j(),d(`ul`,{key:0,ref_key:`floating`,ref:a,style:m(s(p)),class:`menu z-70 max-h-64 flex-nowrap overflow-y-auto rounded-box bg-base-300 p-2 shadow-lg`},[(j(!0),d(u,null,w(s(P),e=>(j(),d(`li`,{key:e,"data-theme":e,class:`rounded-btn`},[l(`button`,{class:o([`btn justify-between btn-xs`,{"btn-active":n.modelValue===e}]),onClick:t=>_(e)},[l(`span`,null,D(e),1),n.modelValue===e?(j(),f(s(I),{key:0,class:`size-4`})):A(``,!0)],10,J)],8,q))),128))],4)):A(``,!0)]))]))}}),oe=Object.assign(Y,{__name:`ThemeSelector`}),se={class:`mx-auto flex h-full max-w-3xl flex-col gap-4 overflow-y-auto px-2 pb-2`},ce={key:0,class:`flex h-64 items-center justify-center`},le={class:`flex flex-col`},ue={key:0,class:`flex flex-col overflow-auto p-4`},de={class:`flex flex-col gap-4`},fe={class:`grid grid-cols-3 gap-2`},pe={class:`fieldset`},me={class:`label truncate`,for:`enable-allow-lan`},he={class:`fieldset`},ge={class:`label truncate`,for:`mode`},_e=[`value`],ve={class:`fieldset`},ye={class:`label truncate`,for:`interface-name`},be={class:`grid grid-cols-3 gap-2`},xe={class:`fieldset`},Se={class:`label truncate`,for:`enable-tun-device`},Ce={class:`fieldset`},we={class:`label truncate`,for:`tun-ip-stack`},Te=[`value`],Ee={class:`fieldset`},De={class:`label truncate`,for:`device-name`},Oe={class:`grid grid-cols-3 gap-2 sm:grid-cols-5`},ke=[`for`],Ae=[`id`,`onUpdate:modelValue`,`placeholder`,`onChange`],je={class:`grid grid-cols-2 gap-4 sm:grid-cols-2`},Me={class:`grid grid-cols-1 gap-4 sm:grid-cols-2`},Ne={class:`flex flex-col gap-2`},Pe={class:`flex flex-col`},Fe={class:`flex flex-col items-center`},Ie={class:`h-10`},Le={class:`flex flex-col`},Re={class:`flex flex-col gap-2`},ze={class:`flex flex-col items-center`},Be={class:`h-10`},Ve={key:0,class:`flex flex-col gap-2`},He={class:`flex flex-col`},Ue={class:`flex flex-col`},We={class:`col-span-1 flex flex-col gap-2 sm:col-span-2`},X=i({__name:`config`,setup(i){let{t:o}=ne();te({title:b(()=>o(`config`))});let m=h(),v=re(),C=a(),O=W(),P=`v${c().public.appVersion||`0.0.0`}`,{data:F,isLoading:I}=r(),{data:L,isLoading:R}=t(),z=e(),B=b(()=>L.value?.includes(`sing-box`)||!1),V=[`Mixed`,`gVisor`,`System`,`LWIP`],G=S({name:``,type:`A`}),K=M([]),q=n({mutationFn:async({name:e,type:t})=>(await U().get(`dns/query`,{searchParams:{name:e||`google.com`,type:t}}).json()).Answer?.map(({data:e})=>e)||[],onSuccess:e=>{K.value=e}});function J(){G.name||(K.value=[])}function Y(){q.mutate({name:G.name,type:G.type})}let X=S({allowLan:!1,mode:`rule`,interfaceName:``,tunEnable:!1,tunStack:`Mixed`,tunDevice:``,mixedPort:0,port:0,socksPort:0,redirPort:0,tproxyPort:0}),Z=M([`rule`,`direct`,`global`]);T(F,e=>{e&&(X.allowLan=e[`allow-lan`]||!1,X.mode=e.mode||`rule`,X.interfaceName=e[`interface-name`]||``,X.tunEnable=e.tun?.enable||!1,X.tunStack=e.tun?.stack||`Mixed`,X.tunDevice=e.tun?.device||``,X.mixedPort=e[`mixed-port`]||0,X.port=e.port||0,X.socksPort=e[`socks-port`]||0,X.redirPort=e[`redir-port`]||0,X.tproxyPort=e[`tproxy-port`]||0,Z.value=e[`mode-list`]||e.modes||[`rule`,`direct`,`global`])},{immediate:!0});let Q=b(()=>[{label:o(`port`,{name:`Mixed`}),key:`mixedPort`,configKey:`mixed-port`},{label:o(`port`,{name:`HTTP`}),key:`port`,configKey:`port`},{label:o(`port`,{name:`Socks`}),key:`socksPort`,configKey:`socks-port`},{label:o(`port`,{name:`Redir`}),key:`redirPort`,configKey:`redir-port`},{label:o(`port`,{name:`TProxy`}),key:`tproxyPort`,configKey:`tproxy-port`}]);function Ge(e){return[`rule`,`direct`,`global`].includes(e)&&o(e)||e}function $(e,t){z.mutate({key:e,value:t})}function Ke(){C.setSelectedEndpoint(``),m.push(`/setup`)}let qe=b(()=>I.value||R.value);return(e,t)=>{let n=ie,r=ae,i=oe,a=H;return j(),d(`div`,se,[s(qe)?(j(),d(`div`,ce,[...t[20]||=[l(`span`,{class:`loading loading-lg loading-spinner`},null,-1)]])):(j(),d(u,{key:1},[s(B)?A(``,!0):(j(),d(u,{key:0},[g(n,{"with-divider":``},{default:E(()=>[x(D(s(o)(`dnsQuery`)),1)]),_:1}),l(`div`,le,[l(`form`,{class:`join`,onSubmit:y(Y,[`prevent`])},[k(l(`input`,{"onUpdate:modelValue":t[0]||=e=>s(G).name=e,type:`search`,class:`input join-item w-full`,placeholder:`google.com`,onInput:J},null,544),[[N,s(G).name]]),k(l(`select`,{"onUpdate:modelValue":t[1]||=e=>s(G).type=e,class:`select join-item max-w-max`},[...t[21]||=[ee(`<option>A</option><option>AAAA</option><option>CNAME</option><option>TXT</option><option>MX</option><option>SRV</option><option>HTTPS</option><option>NS</option><option>DNSKEY</option><option>DS</option><option>SIG</option><option>SOA</option><option>RRSIG</option><option>RP</option>`,14)]],512),[[_,s(G).type]]),g(r,{type:`submit`,class:`join-item max-w-max btn-primary`,loading:s(q).isPending.value},{default:E(()=>[x(D(s(o)(`dnsQuery`)),1)]),_:1},8,[`loading`])],32),s(K).length>0?(j(),d(`div`,ue,[(j(!0),d(u,null,w(s(K),e=>(j(),d(`div`,{key:e,class:`py-2`},D(e),1))),128))])):A(``,!0)])],64)),g(n,{"with-divider":``},{default:E(()=>[x(D(s(o)(`coreConfig`)),1)]),_:1}),l(`div`,de,[l(`div`,fe,[l(`fieldset`,pe,[l(`label`,me,D(s(o)(`allowLan`)),1),k(l(`input`,{id:`enable-allow-lan`,"onUpdate:modelValue":t[2]||=e=>s(X).allowLan=e,type:`checkbox`,class:`toggle`,onChange:t[3]||=e=>$(`allow-lan`,s(X).allowLan)},null,544),[[p,s(X).allowLan]])]),l(`fieldset`,he,[l(`label`,ge,D(s(o)(`runningMode`)),1),k(l(`select`,{id:`mode`,"onUpdate:modelValue":t[4]||=e=>s(X).mode=e,class:`select`,onChange:t[5]||=e=>$(`mode`,s(X).mode)},[(j(!0),d(u,null,w(s(Z),e=>(j(),d(`option`,{key:e,value:e},D(Ge(e)),9,_e))),128))],544),[[_,s(X).mode]])]),l(`fieldset`,ve,[l(`label`,ye,D(s(o)(`outboundInterfaceName`)),1),k(l(`input`,{id:`interface-name`,"onUpdate:modelValue":t[6]||=e=>s(X).interfaceName=e,type:`text`,class:`input min-w-0`,onChange:t[7]||=e=>$(`interface-name`,s(X).interfaceName)},null,544),[[N,s(X).interfaceName]])])]),s(B)?A(``,!0):(j(),d(u,{key:0},[l(`div`,be,[l(`fieldset`,xe,[l(`label`,Se,D(s(o)(`enableTunDevice`)),1),k(l(`input`,{id:`enable-tun-device`,"onUpdate:modelValue":t[8]||=e=>s(X).tunEnable=e,type:`checkbox`,class:`toggle`,onChange:t[9]||=e=>$(`tun`,{enable:s(X).tunEnable})},null,544),[[p,s(X).tunEnable]])]),l(`fieldset`,Ce,[l(`label`,we,D(s(o)(`tunModeStack`)),1),k(l(`select`,{id:`tun-ip-stack`,"onUpdate:modelValue":t[10]||=e=>s(X).tunStack=e,class:`select`,onChange:t[11]||=e=>$(`tun`,{stack:s(X).tunStack})},[(j(),d(u,null,w(V,e=>l(`option`,{key:e,value:e},D(e),9,Te)),64))],544),[[_,s(X).tunStack]])]),l(`fieldset`,Ee,[l(`label`,De,D(s(o)(`tunDeviceName`)),1),k(l(`input`,{id:`device-name`,"onUpdate:modelValue":t[12]||=e=>s(X).tunDevice=e,type:`text`,class:`input min-w-0`,onChange:t[13]||=e=>$(`tun`,{device:s(X).tunDevice})},null,544),[[N,s(X).tunDevice]])])]),l(`div`,Oe,[(j(!0),d(u,null,w(s(Q),e=>(j(),d(`fieldset`,{key:e.key,class:`fieldset`},[l(`label`,{class:`label truncate`,for:e.key},D(e.label),9,ke),k(l(`input`,{id:e.key,"onUpdate:modelValue":t=>s(X)[e.key]=t,type:`number`,class:`input min-w-0`,placeholder:e.label,onChange:t=>$(e.configKey,s(X)[e.key])},null,40,Ae),[[N,s(X)[e.key],void 0,{number:!0}]])]))),128))])],64)),l(`div`,je,[g(r,{class:`btn-primary`,loading:s(O).reloadingConfigFile.value,onClick:s(O).reloadConfigFileAPI},{default:E(()=>[x(D(s(o)(`reloadConfig`)),1)]),_:1},8,[`loading`,`onClick`]),g(r,{class:`btn-warning`,loading:s(O).restartingBackend.value,onClick:s(O).restartBackendAPI},{default:E(()=>[x(D(s(o)(`restartCore`)),1)]),_:1},8,[`loading`,`onClick`]),g(r,{class:`btn-accent`,loading:s(O).flushingFakeIPData.value,onClick:s(O).flushFakeIPDataAPI},{default:E(()=>[x(D(s(o)(`flushFakeIP`)),1)]),_:1},8,[`loading`,`onClick`]),g(r,{class:`btn-info`,loading:s(O).flushingDNSCache.value,onClick:s(O).flushDNSCacheAPI},{default:E(()=>[x(D(s(o)(`flushDNSCache`)),1)]),_:1},8,[`loading`,`onClick`]),s(B)?A(``,!0):(j(),f(r,{key:0,class:`btn-secondary`,loading:s(O).updatingGEODatabases.value,onClick:s(O).updateGEODatabasesAPI},{default:E(()=>[x(D(s(o)(`updateGEODatabases`)),1)]),_:1},8,[`loading`,`onClick`]))])]),g(n,{"with-divider":``},{default:E(()=>[x(D(s(o)(`xdConfig`)),1)]),_:1}),l(`div`,Me,[l(`div`,Ne,[l(`div`,Pe,[g(n,null,{default:E(()=>[x(D(s(o)(`enableTwemoji`)),1)]),_:1}),k(l(`input`,{"onUpdate:modelValue":t[14]||=e=>s(v).enableTwemoji=e,type:`checkbox`,class:`toggle`},null,512),[[p,s(v).enableTwemoji]])]),l(`div`,Fe,[g(n,null,{default:E(()=>[x(D(s(o)(`autoSwitchEndpoint`)),1)]),_:1}),l(`div`,Ie,[k(l(`input`,{"onUpdate:modelValue":t[15]||=e=>s(v).autoSwitchEndpoint=e,type:`checkbox`,class:`toggle`},null,512),[[p,s(v).autoSwitchEndpoint]])])]),l(`div`,Le,[g(n,null,{default:E(()=>[x(D(s(C).currentEndpoint?.url),1)]),_:1}),g(r,{class:`btn-info`,onClick:Ke},{default:E(()=>[x(D(s(o)(`switchEndpoint`)),1)]),_:1})])]),l(`div`,Re,[l(`div`,ze,[g(n,null,{default:E(()=>[x(D(s(o)(`autoSwitchTheme`)),1)]),_:1}),l(`div`,Be,[k(l(`input`,{"onUpdate:modelValue":t[16]||=e=>s(v).autoSwitchTheme=e,type:`checkbox`,class:`toggle`},null,512),[[p,s(v).autoSwitchTheme]])])]),s(v).autoSwitchTheme?(j(),d(`div`,Ve,[l(`div`,He,[g(n,null,{default:E(()=>[x(D(s(o)(`favDayTheme`)),1)]),_:1}),g(i,{modelValue:s(v).favDayTheme,"onUpdate:modelValue":t[17]||=e=>s(v).favDayTheme=e},null,8,[`modelValue`])]),l(`div`,Ue,[g(n,null,{default:E(()=>[x(D(s(o)(`favNightTheme`)),1)]),_:1}),g(i,{modelValue:s(v).favNightTheme,"onUpdate:modelValue":t[18]||=e=>s(v).favNightTheme=e},null,8,[`modelValue`])])])):A(``,!0)]),l(`div`,We,[g(r,{class:`btn-error`,onClick:t[19]||=e=>s(v).resetXdConfig()},{default:E(()=>[x(D(s(o)(`resetSettings`)),1)]),_:1})])]),g(n,{"with-divider":``},{default:E(()=>[x(D(s(o)(`version`)),1)]),_:1}),g(a,{"frontend-version":P,"backend-version":s(L)||``},null,8,[`backend-version`])],64))])}}});export{X as default};